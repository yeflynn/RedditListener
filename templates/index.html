{% extends "base.html" %}

{% block title %}RedditListener - Download Threads{% endblock %}

{% block content %}
<div class="hero">
    <h2>Download Reddit Threads</h2>
    <p>Scrape and analyze Reddit threads with AI-powered summaries</p>
</div>

<div class="form-container">
    <form method="POST" action="{{ url_for('download_threads') }}" class="download-form">
        <div class="form-group">
            <label for="subreddit_url">Subreddit URL or Name:</label>
            <input 
                type="text" 
                id="subreddit_url" 
                name="subreddit_url" 
                placeholder="https://www.reddit.com/r/FacebookMarketplace/ or r/FacebookMarketplace"
                required
            >
            <small>Enter the full URL or just the subreddit name (e.g., r/FacebookMarketplace)</small>
        </div>

        <div class="form-group">
            <label>
                <input 
                    type="checkbox" 
                    id="skip_date_filter" 
                    name="skip_date_filter"
                    onchange="toggleDateInputs()"
                >
                Skip date filtering (download all threads regardless of date)
            </label>
        </div>

        <div class="form-row" id="date_inputs">
            <div class="form-group">
                <label for="start_date">Start Date (Optional):</label>
                <input 
                    type="date" 
                    id="start_date" 
                    name="start_date"
                >
            </div>

            <div class="form-group">
                <label for="end_date">End Date (Optional):</label>
                <input 
                    type="date" 
                    id="end_date" 
                    name="end_date"
                >
            </div>
        </div>

        <script>
        function toggleDateInputs() {
            const checkbox = document.getElementById('skip_date_filter');
            const dateInputs = document.getElementById('date_inputs');
            const startDate = document.getElementById('start_date');
            const endDate = document.getElementById('end_date');
            
            if (checkbox.checked) {
                dateInputs.style.opacity = '0.5';
                dateInputs.style.pointerEvents = 'none';
                startDate.disabled = true;
                endDate.disabled = true;
            } else {
                dateInputs.style.opacity = '1';
                dateInputs.style.pointerEvents = 'auto';
                startDate.disabled = false;
                endDate.disabled = false;
            }
        }
        </script>

        <div class="form-group">
            <label for="gemini_model">Gemini AI Model:</label>
            <select 
                id="gemini_model" 
                name="gemini_model"
            >
                <option value="gemini-2.5-flash" selected>Gemini 2.5 Flash (Latest, Fastest)</option>
                <option value="gpt-4.1-mini">GPT-4.1 Mini (Balanced)</option>
                <option value="gpt-4.1-nano">GPT-4.1 Nano (Fastest, Lightweight)</option>
            </select>
            <small>Select the AI model for generating thread summaries</small>
        </div>

        <div class="form-group">
            <label for="max_threads">Max Threads to Download:</label>
            <input 
                type="number" 
                id="max_threads" 
                name="max_threads" 
                value="10" 
                min="1" 
                max="100"
                required
            >
            <small>Maximum: 100 threads</small>
        </div>

        <button type="submit" class="btn btn-primary">
            ðŸ“¥ Download Threads
        </button>
    </form>
</div>

<div class="info-section">
    <h3>How It Works</h3>
    <div class="steps">
        <div class="step">
            <div class="step-number">1</div>
            <h4>Enter Subreddit</h4>
            <p>Provide the subreddit URL or name you want to scrape</p>
        </div>
        <div class="step">
            <div class="step-number">2</div>
            <h4>Set Parameters</h4>
            <p>Choose date range and maximum number of threads</p>
        </div>
        <div class="step">
            <div class="step-number">3</div>
            <h4>Download & Store</h4>
            <p>Threads are scraped and saved to local database</p>
        </div>
        <div class="step">
            <div class="step-number">4</div>
            <h4>AI Summarization</h4>
            <p>Generate summaries using Gemini AI</p>
        </div>
    </div>
</div>
{% endblock %}
